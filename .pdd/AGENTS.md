# .pdd/ ディレクトリのドキュメント編集ルール

このディレクトリには、Plan Driven Development (PDD) の作業ドキュメントが格納されます。このディレクトリ内でファイルを作成・編集する際は、以下のルールに従ってください。

## ドキュメントの種類

### PLAN.md

**目的**: 機能仕様と実装タスクの分解

**作成タイミング**: 機能ブランチ作成時（必須）

**構造**:

- h1: `# PLAN`（必須）
- h2-h4: 使用可（過度なネストは避ける）

**内容**:

- 背景と目的
- 詳細な仕様
- タスク分解（チェックリスト形式）
- 技術的判断とその根拠

**記述例**:

```markdown
# PLAN

## 背景

外部 API 連携により、データの取得と更新が必要。

## 目的

- ID による詳細取得
- ステータスの更新
- クエリによる検索

## タスク

- [ ] API ドキュメントの調査
- [ ] 認証機能の実装
- [ ] ツールの作成
- [ ] テストの追加
- [ ] ドキュメントの更新

## 技術的判断

FastMCP のツールデコレーターを使用し、JSON スキーマを自動生成する。
```

### NOTES_%Y%m%d_%H%M%S.md

**目的**: 発見事項、問題、解決策を記録する作業ログ

**作成タイミング**: 計画フェーズ（調査時）および実装フェーズのマイルストーンごと

**タイムスタンプ形式**: `date +%Y%m%d_%H%M%S` の出力をそのまま使用（例: `20251216_143022`）

**構造**:

- ファイル名: `NOTES_%Y%m%d_%H%M%S.md`（タイムスタンプ形式厳守）
- h1: ファイル名と一致（例: `# NOTES_20251216_143022`）
- h2 セクションのみ使用（h3 以下は不可）
- 各セクション内に参照リンクを含める

**記述例**:

```markdown
# NOTES_20251216_143022

## API 調査

API は API キー認証が必要。
エンドポイント: `https://api.example.com/v1/`

参考: https://docs.example.com/api/

## 認証の問題

Basic 認証での最初の試みは失敗。
解決策: ヘッダーに API キーを指定する。

## 次のステップ

適切なエラーハンドリングを含むツールを実装する。
```

## 記述ルール

### 共通ルール

- **絵文字禁止**: パーサーとの互換性のため
- **水平線禁止**（`---`）: Markdown パーサーによる解釈の違いを避けるため
- **簡潔・事実ベース**: 事実を直接記述し、冗長な説明を避ける
- **具体例を優先**: コードや設定は抽象的な説明より具体例を示す

### セキュリティルール（重要）

`.pdd/` は Git 除外されていますが、以下は記載しないこと:

- 秘密鍵、トークン、パスワード
- API キー、認証情報
- 個人情報（名前、メール、ユーザー名）
- ローカル環境のパス（例: `/Users/username/`）

**理由**: 誤コミット、スクリーンショット、共有により機密情報が流出する可能性

**記載可能な情報**:

- プロジェクト ID、リソース名
- 公開ドキュメントの URL
- 一般的な設定パターン

### タイムスタンプの生成

NOTES のファイル名には、必ず `date +%Y%m%d_%H%M%S` の出力をそのまま使用:

```bash
# タイムスタンプ生成
date +%Y%m%d_%H%M%S
# 出力例: 20251216_143022

# NOTES ファイル作成
touch .pdd/feat-add-tool/NOTES_20251216_143022.md
```

**禁止事項**:

- 手動でタイムスタンプを入力
- 異なる形式を使用（ISO 8601 など）
- 余計な区切り文字や文字を追加

## ワークフローとの連携

これらのドキュメントは PDD ワークフローと連携します:

1. **計画フェーズ**: PLAN.md を作成、調査結果を NOTES に記録
2. **実装フェーズ**: PLAN.md に沿って実装、マイルストーンごとに NOTES を作成
3. **PR フェーズ**: PLAN.md と NOTES の完全性を確認
4. **マージ後**: `.pdd/{branch}/` は自動削除（Git 除外）

## 参考

PDD ワークフローのガイダンスは、VS Code Copilot Chat の `pdd` カスタムエージェントを使用してください。

開発哲学全般については、リポジトリルートの `/AGENTS.md` を参照してください。
